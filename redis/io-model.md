## redis IO模型

解释一下什么是IO模型：
键值数据库网络框架接收到网络包，并按照相应的协议进行解析之后，就可以知道客户端具体想要做的操作，并开始实际的执行相应操作。
此时，我们会遇到一个系统设计上的问题，简单来说，就是网络连接的处理、网络请求的解析，以及数据存取的处理，是用一个线程还是多个线程，
还是多个进程来交互处理呢？该如何进行设计和取舍呢？我们一般把这个问题称为 I/O 模型设计。
不同的 I/O 模型对键值数据库的性能和可扩展性会有不同的影响。

我们知道 redis 的IO模型是单线程，Redis 单线程主要是指 Redis 的网络 IO 和键值对读写是由一个线程来完成的，
这也是 Redis 对外提供键值存储服务的主要流程。但 Redis 的其他功能，比如持久化、异步删除、集群数据同步等，其实是由额外的线程执行的。

### 为什么使用单线程

使用多线程，可以增加系统吞吐率，或是可以增加系统扩展性。
对于一个多线程的系统来说，在有合理的资源分配的情况下，可以增加系统中处理请求操作的资源实体，进而提升系统能够同时处理的请求数，即吞吐率。
但是，通常情况下，在我们采用多线程后，如果没有良好的系统设计，并不会有预想中的效果。
刚开始增加线程数时，系统吞吐率会增加，但是，再进一步增加线程时，系统吞吐率就增长迟缓了，有时甚至还会出现下降的情况。
一个关键的瓶颈在于，系统中通常会存在被多线程同时访问的共享资源，比如一个共享的数据结构。
当有多个线程要修改这个共享资源时，为了保证共享资源的正确性，就需要有额外的机制进行保证，而这个额外的机制，就会带来额外的开销。
这就是多线程编程模式面临的共享资源的并发访问控制问题。

并发访问控制一直是多线程开发中的一个难点问题，如果没有精细的设计，比如说，只是简单地采用一个粗粒度互斥锁，
就会出现不理想的结果：即使增加了线程，大部分线程也在等待获取访问共享资源的互斥锁，并行变串行，系统吞吐率并没有随着线程的增加而增加。
而且，采用多线程开发一般会引入同步原语来保护共享资源的并发访问，这也会降低系统代码的易调试性和可维护性。
为了避免这些问题，Redis 直接采用了单线程模式。

### redis单线程为什么这么快

[Socket](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b0aca7fa9d6400c87b3afb3603c29c8~tplv-k3u1fbpfcp-watermark.awebp)